package br.org.iamar.sgci;


import java.io.InputStream;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.google.firebase.FirebaseApp;
import com.google.firebase.FirebaseOptions;
import com.google.firebase.auth.FirebaseCredentials;
import com.google.firebase.database.FirebaseDatabase;


@Configuration
public class FirebaseConfig {
    
    private static final Logger LOG = LoggerFactory.getLogger(FirebaseConfig.class);

    public FirebaseConfig() {
        
        LOG.debug( "Initializing Firebase connection." );

        InputStream serviceAccountKey = getClass().getClassLoader().getResourceAsStream( "firebase/ezapeServiceAccountKey.json" );

        FirebaseOptions options = new FirebaseOptions.Builder().setCredential( FirebaseCredentials.fromCertificate( serviceAccountKey ) )
            .setDatabaseUrl( "https://ezape-2a9e0.firebaseio.com/" ).build();

        FirebaseApp.initializeApp( options );
        
        LOG.debug( "Firebase connection initialized." );

    }
    
    @Bean( name = "firebaseDatabase" )
    public FirebaseDatabase firebaseDatabase(){
        return FirebaseDatabase.getInstance();
    }

}
